---
title: "Hotel Bookings"
output: html_notebook
---
---
The scenario:
In this example, you are a junior data analyst working for the  hotel booking company.
Your Marketing head is interested in developing a promotions for the hotel types.They want you to answer a HOW and WHAT.
*How are the hotels being used
*What should be the target audience for the marketing campaign.


Install all the required packages
```{r}
install.packages("tidyverse")
install.packages("lubridate")
install.packages("skimr")
install.packages("janitor")

```

```{r}
library(tidyverse)
library(lubridate)
library(skimr)
library(janitor)
library(ggplot2)
library(tidyr)

```


Checking the current directory
```{r}
getwd() 
```
Importing the data 
```{r}
bookings <- read.csv("hotel_bookings.csv",header = TRUE, sep=",")
```


Explore the column names and rename to make them more consistent
```{r}
colnames(bookings)
str(bookings)
skim_without_charts(bookings)

data <- bookings
data<-rename(data,hotel_type=hotel,
       canceled_status=is_canceled,
       arrival_year=arrival_date_year,
       arrival_month=arrival_date_month,
       arrival_date=arrival_date_day_of_month)
rename_with(data,tolower)
```

```{r}
data<-unite(data,col='arrival_date_', c('arrival_date', 'arrival_month', 'arrival_year'),sep=" ")

data['reservation_status'][data['reservation_status'] == 'No-Show'] <- 'Canceled'
data['children'][data['children'] == 'NA'] <- 0

data<- mutate(data,num_of_childs = (children+babies))


# checking if we successfully replaced the no-show to canceled
filter(data,reservation_status == 'No-Show')
filter(data,children== 'NA')

```

Let's take a look at the average daily rate (adr) for two different types of hotel.

The data reveals that city hotel is higher on average daily rate.
Ooh the data has a surprise for us,we found that the maximum adr foe city hotel has a really high value while the minimum adr for the resort hotel has a negative value.

```{r}
city_hotels <-
  filter(data, hotel_type == 'City Hotel') %>%
  pull('adr')
min(city_hotels)
max(city_hotels)
mean(city_hotels)

resort_hotels <-
  filter(data, hotel_type == 'Resort Hotel') %>%
  pull('adr')
min(resort_hotels)
max(resort_hotels)
mean(resort_hotels)
```
Are people travelling in whim?

There are only about 5.3% of the total people who are travelling in Whim.


```{r}
data %>%
  select(hotel_type,lead_time,country)%>%
  filter(lead_time<1)%>%
  arrange(country)


data %>%
  select(hotel_type,lead_time,country)%>%
  filter(lead_time<1)%>%
  group_by(country,hotel_type)%>%
  tally()%>%
  arrange(country)

data %>%
  select(hotel_type,lead_time,country)%>%
  filter(lead_time<1)%>%
  group_by(hotel_type)%>%
  tally()

```
Number of bookings from 2015-2017

2016 has the highest number of bookings


```{r}
bookings %>%
  filter(is_canceled==0)%>%
  group_by(arrival_date_year,hotel)%>%
  tally()

ggplot(bookings)+
  geom_bar(mapping=aes(x=arrival_date_year,fill=is_canceled))+
  facet_wrap(~is_canceled)


```



Customer having at least one kid

The stakeholder has a hypothesis that the resort hotel is being used by families as a vaccation spot.The data has contradiction with the proposed hypothesis of stakeholder.
Families with at least one kid visit city hotel more than the resort hotel.It might be due to cost difference between 
the two different type of hotels or the transportation facility.Also we found that the the total bookings with at least one kid is quite low.
```{r}
data %>%
  select(hotel_type,num_of_childs)%>%
  filter(num_of_childs>=1)%>%
  group_by(hotel_type)%>%
  tally()
```


let us focus on the early bookings
```{r}
data %>%
  select(hotel_type,lead_time,adults,num_of_childs)%>%
  filter(lead_time>=1,num_of_childs>=1)%>%
  group_by(hotel_type)%>%
  tally()

ggplot(data) +
  geom_jitter(mapping = aes(x = lead_time, y = num_of_childs,color=num_of_childs,size=num_of_childs))+
  labs(title='Customer with early bookings')
  
```
Stays in week nights and weekend nights

bookings involving zero number of kids has a higher number of stays in weekends

```{r}
data %>%
  select(hotel_type,stays_in_weekend_nights,adults,num_of_childs)%>%
  filter(stays_in_weekend_nights>=1) %>%
  arrange(num_of_childs)%>%
  group_by(num_of_childs,hotel_type)%>%
  tally()

ggplot(data) +
  geom_jitter(mapping = aes(x =stays_in_weekend_nights , y =num_of_childs,colour=stays_in_weekend_nights))+
  labs(title='number of kids Vs stays at weekend nights')

#weekday nights
data %>%
  select(hotel_type,stays_in_week_nights,adults,num_of_childs)%>%
  filter(stays_in_week_nights>=1) %>%
  arrange(num_of_childs)%>%
  group_by(num_of_childs,hotel_type)%>%
  tally()

ggplot(data) +
  geom_jitter(mapping = aes(x =stays_in_week_nights , y =num_of_childs,colour=stays_in_week_nights))+
  labs(title='number of kids Vs stays at week nights')

```
Trip duration

There are only a few number of trips for less than one day.We can say that there are only few local people visiting the hotels,hotels are being used by the travellers and tourists


```{r}
#LESS THAN ONE DAY TRIP
data %>%
  filter(stays_in_week_nights==0 & stays_in_weekend_nights==0)%>%
  group_by(hotel_type,num_of_childs)%>%
  tally()

#for more than one day
data %>%
  filter(stays_in_week_nights!=0 | stays_in_weekend_nights!=0)%>%
  group_by(hotel_type,num_of_childs)%>%
  tally()
```
Total number bookings

```{r}
data%>%
  group_by(num_of_childs)%>%
  tally()
data%>%
  group_by(hotel_type)%>%
  tally()
```
Canceled bookings
```{r}
data%>%
  count(canceled_status==1)
```

let us Examine the number of bookings vs the market segments and distribution channel.

we get a better understanding of what the target audience should be.the data revealed that the best market segment to target on is the online TA/TO.

```{r}
#which market segment has highest bookings
market<-(data%>%
           group_by(market_segment,hotel_type)%>%
           tally()%>%
           arrange(hotel_type))
market<- rename(market,num_of_bookings=n)

#num of bookings vs distribution channel
channel<-(data%>%
           group_by(distribution_channel,hotel_type)%>%
           tally()%>%
           arrange(hotel_type))
channel<- rename(channel,num_of_bookings=n)
  
#visualizng the bookings vs market segment and distribution channel

ggplot(data) +
  geom_bar(mapping = aes(x = market_segment, fill=hotel_type)) +
  facet_wrap(~hotel_type)+
  theme(axis.text.x = element_text(angle = 45))+
  labs(title="Comparison of market segments by hotel type for hotel bookings",
       subtitle=paste0("Data from: ", '2015', " to ", '2017'),
       x='Market Segment',
       Y='Num_of_bookings')

ggplot(data) +
  geom_bar(mapping = aes(x = distribution_channel, fill=hotel_type)) +
  facet_grid(~hotel_type)+
  theme(axis.text.x = element_text(angle = 45))+
  labs(title="Comparison of distribution channel by hotel type for hotel bookings",
       subtitle=paste0("Data from: ", '2015', " to ", '2017'),
       x='distribution channel',
       y='num of bookings')

ggplot(data) +
  geom_bar(mapping = aes(x = distribution_channel,fill=deposit_type)) +
  facet_wrap(~deposit_type) +
  theme(axis.text.x = element_text(angle = 45))+
  labs(title="Comparison of distribution channel by hotel type for hotel bookings",
       subtitle=paste0("Data from: ", '2015', " to ", '2017'),
       x='distribution channel',
       y='num of bookings')

ggplot(data) +
  geom_bar(mapping = aes(x = distribution_channel)) +
  facet_wrap(~deposit_type~market_segment) +
  theme(axis.text.x = element_text(angle = 45))+
  labs(title="Comparison of distribution channel by market segment and deposit type for hotel bookings",
       subtitle=paste0("Data from: ", '2015', " to ", '2017'),
       x='distribution channel',
       y='num of bookings')

```

